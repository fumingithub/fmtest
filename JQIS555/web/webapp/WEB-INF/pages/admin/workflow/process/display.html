<#include "../../../common/_public.html"/>
<!--<link rel="stylesheet" href="${ctx}/workflow/snaker/snaker.css" type="text/css" media="all"/>-->
<script src="${ctx}/workflow/raphael-min.js" type="text/javascript"></script>
<!--<script src="${ctx}/workflow/jquery.min.js" type="text/javascript"></script>-->
<!--<script src="${ctx}/workflow/jquery-ui.min.js" type="text/javascript"></script>-->
<script src="${ctx}/workflow/snaker/snaker.designer.js" type="text/javascript"></script>
<script src="${ctx}/workflow/snaker/snaker.model.js" type="text/javascript"></script>
<!--<script src="${ctx}/workflow/snaker/snaker.editors.js" type="text/javascript"></script>-->

<div class="bjui-pageContent">

    <div class="bjui-pageHeader">
        <div class="office">
            <ul class="offbtn">
                <li><a class="closecutab"><span class="hecv-nav-close"></span>关闭</a>
            </ul>
        </div>

    </div>

    <div style="margin:15px auto 0; width:900px;">
        <fieldset>
            <legend>
                <h3 class="listtitle">查看工作流</h3>
            </legend>
            流程名称：<font color="red">${order.processName }</font>&nbsp;&nbsp;
            流程编号：<font color="red">${order.orderNo }</font>&nbsp;&nbsp;
            流程创建时间：<font color="red">${order.createTime }</font>
            <table data-width="100%" data-nowrap="true" data-selected-multi="false"
                   class="table table-bordered table-hover table-striped table-top" data-toggle="tablefixed">
                <thead>
                <tr>
                    <th align=center width=30% class="td_list_1" nowrap>
                        任务名称
                    </th>
                    <th align=center width=30% class="td_list_1" nowrap>
                        任务创建时间
                    </th>
                    <th align=center width=20% class="td_list_1" nowrap>
                        任务完成时间
                    </th>
                    <th align=center width=20% class="td_list_1" nowrap>
                        任务处理人
                    </th>
                </tr>
                </thead>
                <tbody>
                <#list tasks as item>
                    <tr>
                        <td class="td_list_2" align=left nowrap>
                            ${item.displayName!}
                        </td>
                        <td class="td_list_2" align=left nowrap>
                            ${item.createTime!}
                        </td>
                        <td class="td_list_2" align=left nowrap>
                            ${item.finishTime!}
                        </td>
                        <td class="td_list_2" align=left nowrap>
                            ${item.operator!}
                        </td>
                    </tr>
                </#list>
                </tbody>
            </table>
        </fieldset>
        <div id="snakerflow" style="width:900px; height:350px;overflow:hidden;">
        </div>
    </div>
</div>
<script type="text/javascript">

	function display(process, active) {
		/** view*/
		$('#snakerflow').snakerflow($.extend(true,{
			basePath : "${ctx}/workflow/snaker/",
            ctxPath : "${ctx}",
            orderId : "${order.id}",
			restore : eval("(" + process + ")")
			,
			editable : false
			},eval("(" + active + ")")
		));
	}




</script>
<script type="text/javascript">
		$.ajax({
				type:'GET',
				url:"${ctx}/admin/workflow/process!json.do",
				data:"processId=${processId}&orderId=${order.id}",
				async: false,
				globle:false,
				error: function(){
					alert('数据处理错误！');
					return false;
				},
				success: function(data){
					display(data.process, data.active);
				}
			});




</script>