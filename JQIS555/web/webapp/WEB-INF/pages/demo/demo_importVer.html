<#include "../common/_public.html"/>
<div id="loading" style="display:none;width:100%;height:120%;text-align:center;padding-top:20%; position: absolute;alpha(opacity=45); opacity:0.45;background-color:#FFFFFF;z-index:1000;">
</div>
<div id="load" style="display:none;width:100%;height:120%;text-align:center;padding-top:20%; position: absolute;alpha(opacity=45);z-index:1000;">
    <h3><img style="height:40px;width:40px;text-align:center;"src="${ctx}/BJUI/themes/css/img/load.gif" ></h3>
    正在导入数据，请稍候...
</div>
<div class="bjui-pageHeader">
    <div class="office">
        <ul class="offbtn">
            <li> <a  class="a-close closecutab"><span class="iconbg03"><i class="fa fa-remove  font24"></i></span>关闭</a> </li>
        </ul>
    </div>
</div>
<div class="bjui-pageContent">
    <div style="margin:15px auto 0; width:800px;">
        <fieldset>
            <legend><h3>上传文件</h3></legend>
            <div style="display:inline-block; vertical-align:middle;">
                <div id="doc_excel_up" data-toggle="upload" data-uploader="${ctx}/admin/system/upload!uploadFile.do"
                     data-file-size-limit="1024000000"
                     data-auto="true"
                     data-file-type-exts="*.xlsx"
                     data-multi="false" class="bjui-upload"
                     data-on-upload-success="doc_upload_success"
                     data-icon="cloud-upload"></div>
                <input type="hidden" name="doc.excel" value="" id="doc_excel">
            </div>
            <br>
            <span id="doc_span_excel"></span>
        </fieldset>
    </div>
    <div style="margin:15px auto 0; width:800px;">
        <div class="operate">
            <a class="btn btn-blue row-del" onclick="doImport(this)">
                <input type="hidden" id="attachmentId" name="attachmentId" value="">导入数据库
            </a>
        </div>
    </div>
    <div class="warm-tips">
        <label>温馨提示：</label>
        <div>
            <span>1.上传你需要导入数据库的文件</span>
            <span>2.上传成功后，请点击"导入数据库"。</span>
        </div>
    </div>
</div>

<script type="text/javascript">
    function doc_upload_success(file, data) {
        var json = $.parseJSON(data);
        $(this).bjuiajax("ajaxDone", json);
        if (json.flag) {
            $(this).alertmsg("correct", "上传成功！");
            $('#doc_span_excel').html(json.name); // 获取文件名称
            $('#attachmentId').val(json.attachmentId); // 获得附件ID的值
        }
    }

    /**
     * 导入数据库
     * @param obj
     */
    function doImport(obj) {
    	$(obj).alertmsg("correct", "导入成功");
        $(obj).dialog("close", $.CurrentDialog);
    }
</script>